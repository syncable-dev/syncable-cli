# Vulnerability Checking in Syncable CLI

The Syncable CLI includes comprehensive vulnerability checking for dependencies across all supported languages. This document describes how vulnerability checking works and how to use it.

## Supported Languages

The CLI can check vulnerabilities for dependencies in the following languages:

- **Rust** - Uses `cargo-audit` to check against the RustSec Advisory Database
- **JavaScript/TypeScript** - Uses `npm audit` to check npm packages
- **Python** - Uses `pip-audit` to check PyPI packages
- **Go** - Uses `govulncheck` to check Go modules
- **Java/Kotlin** - Uses OWASP `dependency-check` to check Maven/Gradle dependencies

## Usage

### Check vulnerabilities in the current directory:
```bash
iac-gen vulnerabilities
```

### Check vulnerabilities in a specific project:
```bash
iac-gen vulnerabilities /path/to/project
```

### Filter by severity:
```bash
iac-gen vulnerabilities --severity high
```

Available severity levels: `low`, `medium`, `high`, `critical`

### Export results:
```bash
# Export as JSON
iac-gen vulnerabilities --format json --output report.json

# Export as table (default)
iac-gen vulnerabilities --output report.txt
```

### Check vulnerabilities as part of dependency analysis:
```bash
iac-gen dependencies --vulnerabilities /path/to/project
```

## Required Tools

For full vulnerability checking capabilities, you need to install the following tools:

### Rust
```bash
cargo install cargo-audit
```

### JavaScript/TypeScript
npm is included with Node.js installation

### Python
```bash
pip install pip-audit
```

### Go
```bash
go install golang.org/x/vuln/cmd/govulncheck@latest
```

### Java/Kotlin
Download from: https://owasp.org/www-project-dependency-check/

Or on macOS:
```bash
brew install dependency-check
```

## How It Works

1. **Dependency Detection**: The CLI first analyzes your project to detect all dependencies for each language.

2. **Vulnerability Scanning**: For each detected language, it runs the appropriate vulnerability checking tool:
   - Rust: Executes `cargo audit --json` and parses the output
   - JavaScript: Executes `npm audit --json` and parses the output
   - Python: Executes `pip-audit --format json` and parses the output
   - Go: Executes `govulncheck -json` and parses the output
   - Java: Executes `dependency-check` with appropriate flags and parses the JSON report

3. **Report Generation**: All vulnerabilities are aggregated into a unified report showing:
   - Total vulnerability count
   - Breakdown by severity (Critical, High, Medium, Low)
   - Affected dependencies with details
   - Available patches/fixes when known

## Vulnerability Report Format

The vulnerability report includes:

- **Vulnerability ID**: CVE, GHSA, or advisory ID
- **Severity**: Critical, High, Medium, Low, or Info
- **Title**: Brief description of the vulnerability
- **Description**: Detailed explanation
- **Affected Versions**: Version ranges affected
- **Patched Versions**: Fixed versions if available
- **References**: Links to advisories and more information

## Example Output

```
üõ°Ô∏è  Vulnerability Scan Report
================================================================================
Scanned at: 2024-01-15 10:30:45 UTC
Path: /Users/example/project

Summary:
Total vulnerabilities: 3

By Severity:
  üî¥ HIGH: 2
  üü° MEDIUM: 1

--------------------------------------------------------------------------------
Vulnerable Dependencies:

üì¶ lodash v4.17.20 (JavaScript)

  ‚ö†Ô∏è  CVE-2021-23337 [HIGH]
     Command Injection in lodash
     Lodash versions prior to 4.17.21 are vulnerable to Command Injection...
     CVE: CVE-2021-23337
     Affected: <4.17.21
     ‚úÖ Fix: Upgrade to >=4.17.21

üì¶ django v3.0.0 (Python)

  ‚ö†Ô∏è  CVE-2021-3281 [MEDIUM]
     Directory Traversal in Django
     Django before 2.2.18, 3.0.x before 3.0.12, and 3.1.x before 3.1.6...
     CVE: CVE-2021-3281
     Affected: >=3.0.0,<3.0.12
     ‚úÖ Fix: Upgrade to >=3.0.12
```

## CI/CD Integration

The vulnerability check command exits with:
- **0**: No vulnerabilities found
- **1**: Critical or High severity vulnerabilities found
- **2**: Other errors

This makes it easy to integrate into CI/CD pipelines:

```yaml
# GitHub Actions example
- name: Check vulnerabilities
  run: iac-gen vulnerabilities --severity high
```

## Limitations

- Vulnerability checking requires the respective language tools to be installed
- Some tools may require internet access to download vulnerability databases
- Results depend on the accuracy and completeness of the vulnerability databases
- The tool gracefully handles missing scanners by warning the user and continuing

## Security Best Practices

1. **Regular Scanning**: Run vulnerability checks regularly, ideally as part of CI/CD
2. **Update Dependencies**: Keep dependencies up to date to get security patches
3. **Review Reports**: Don't ignore Medium and Low severity issues - they can still be exploited
4. **Use Lock Files**: Ensure reproducible builds with lock files (Cargo.lock, package-lock.json, etc.)
5. **Monitor Advisories**: Subscribe to security advisories for your key dependencies 