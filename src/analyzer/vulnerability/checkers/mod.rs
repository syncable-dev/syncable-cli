//! # Language-specific vulnerability checkers

pub mod rust;
pub mod javascript;
pub mod python;
pub mod go;
pub mod java;

pub use rust::RustVulnerabilityChecker;
pub use javascript::JavaScriptVulnerabilityChecker;
pub use python::PythonVulnerabilityChecker;
pub use go::GoVulnerabilityChecker;
pub use java::JavaVulnerabilityChecker;

use std::path::Path;
use crate::analyzer::dependency_parser::DependencyInfo;
use super::types::{VulnerableDependency, VulnerabilityError};

/// Common trait for language-specific vulnerability checkers
pub trait LanguageVulnerabilityChecker {
    fn check_vulnerabilities(
        &self, 
        dependencies: &[DependencyInfo], 
        project_path: &Path
    ) -> Result<Vec<VulnerableDependency>, VulnerabilityError>;
}

/// Extension trait for mutable vulnerability checkers
pub trait MutableLanguageVulnerabilityChecker {
    fn check_vulnerabilities(
        &mut self, 
        dependencies: &[DependencyInfo], 
        project_path: &Path
    ) -> Result<Vec<VulnerableDependency>, VulnerabilityError>;
}